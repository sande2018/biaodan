# 在线报名系统

一个基于Python Flask和Bootstrap的在线报名系统，支持多表单管理、CDK奖励、IP限制等功能。

## 功能特性

### 1. 响应式设计
- 使用Bootstrap框架实现，支持手机、平板、电脑等各种设备
- 自适应不同屏幕尺寸

### 2. 表单管理系统
- 管理员可创建多个不同的报名表单
- 表单字段模块化管理（字段类型、验证规则、显示样式等）
- 支持多种字段类型：文本框、邮箱、电话、下拉选择、单选按钮、复选框、多行文本

### 3. 分享链接
- 每个表单自动生成唯一的分享链接
- 用户无需注册即可直接填写

### 4. CDK奖励功能
- 可选择开启CDK奖励
- 设置CDK库存数量和兑奖说明
- 支持打开表单时弹出鼓励提示
- 提交成功后自动分配CDK并更新库存

### 5. 填写进度条
- 实时显示用户填写进度
- 与表单字段填写状态同步更新

### 6. IP限制
- 可设置单IP最大提交次数
- 记录用户IP地址和设备信息
- 超过限制时拒绝提交

### 7. 异常处理
- 网络异常、数据库连接失败等情况的友好提示
- 严格的数据验证，防止恶意输入

### 8. 状态管理
- 记录表单创建时间、最后修改时间
- 表单启用/禁用状态
- CDK库存状态

## 技术栈

- **后端**: Python Flask
- **前端**: Bootstrap 5
- **数据库**: SQLite（可扩展为MySQL/PostgreSQL）
- **ORM**: SQLAlchemy

## 项目结构

```
在线报名模块/
├── app/
│   ├── __init__.py      # 应用初始化
│   ├── models.py        # 数据库模型
│   ├── routes.py        # 路由定义
│   ├── static/          # 静态文件
│   └── templates/       # 模板文件
│       ├── base.html    # 基础模板
│       ├── index.html   # 首页
│       ├── fill_form.html    # 表单填写页
│       ├── submission_success.html  # 提交成功页
│       └── admin/       # 管理后台模板
├── migrations/          # 数据库迁移文件
├── requirements.txt     # 依赖列表
├── run.py               # 应用入口
└── README.md            # 项目说明
```

## 安装和运行

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 初始化数据库

```bash
flask db init
flask db migrate
flask db upgrade
```

### 3. 运行应用

```bash
python run.py
```

应用将在 http://localhost:5000 运行

### 4. 访问管理后台

打开浏览器访问 http://localhost:5000/admin

## 使用说明

### 创建表单

1. 登录管理后台
2. 点击"创建新表单"
3. 填写表单基本信息
4. 配置CDK奖励和IP限制（可选）
5. 点击"创建表单"

### 添加表单字段

1. 在表单列表中点击"管理字段"
2. 填写字段信息：名称、标签、类型、顺序等
3. 配置选项（适用于下拉、单选、复选框）
4. 设置验证规则（可选）
5. 点击"添加字段"

### 分享表单

1. 在表单列表中点击"预览表单"
2. 复制浏览器地址栏的URL
3. 将该URL分享给用户

### 查看提交记录

（当前版本需要通过数据库查看，后续版本将添加后台查看功能）

## 配置说明

### 表单设置

- **表单名称**: 表单的显示名称
- **表单标识 (Slug)**: 用于生成分享链接的唯一标识
- **描述**: 表单的说明文字
- **启用状态**: 控制表单是否可访问

### CDK设置

- **启用CDK奖励**: 开启或关闭CDK功能
- **CDK库存数量**: 可用的CDK数量
- **兑奖说明**: 告知用户如何使用CDK
- **弹出提示**: 打开表单时是否显示鼓励填写的提示

### IP限制设置

- **单IP最大提交次数**: 0表示无限制，大于0表示限制次数

## 字段类型说明

- **文本框**: 普通文本输入
- **邮箱**: 带邮箱格式验证
- **电话**: 电话格式输入
- **下拉选择**: 从选项中选择一个
- **单选按钮**: 从选项中选择一个（可视化）
- **复选框**: 从选项中选择多个
- **多行文本**: 长文本输入

## 验证规则

验证规则使用JSON格式，例如：

```json
{"min_length": 2, "max_length": 50}
```

当前支持的验证规则：
- min_length: 最小长度
- max_length: 最大长度

## 开发说明

### 数据库模型

- **Form**: 表单基本信息
- **FormField**: 表单字段
- **FormSubmission**: 表单提交记录
- **CDK**: CDK信息

### 路由结构

- /: 首页
- /admin: 管理后台
- /admin/form/create: 创建表单
- /admin/form/<id>/fields: 管理表单字段
- /form/<slug>: 表单填写页
- /api/form/<slug>/fields: 获取表单字段API

## 后续改进

1. 添加表单提交记录的后台查看功能
2. 支持CDK批量导入
3. 添加表单导出功能
4. 支持邮件通知
5. 添加用户认证系统
6. 支持多语言

## 许可证

MIT License
